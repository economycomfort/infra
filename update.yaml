---
## Handles updating access and packages on defined hosts.

  - hosts: all
    become: yes

  - hosts: proxmox
    tasks:
    roles:
      - role: simoncaron.pve_addons

  - hosts: srv:pihole:proxmox
    become: yes
    tasks:
      - name: import keys from github
        ansible.posix.authorized_key:
          user: "{{ ansible_user }}"
          state: present
          key: https://github.com/economycomfort.keys

      - name: update packages
        ansible.builtin.package:
          name: '*'
          state: latest
          
    roles:
      - role: dab-motd

  - hosts: pihole
    tasks:
    - name: update pihole
      command: 'pihole -up'

